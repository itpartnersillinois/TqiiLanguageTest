@page
@model TqiiLanguageTest.Pages.ReadingAnswerModel
@{
}

<h1>Interactive Reading</h1>

@if (Model != null && Model.Answer != null && Model.Answer.HasInteractiveReadingImage)
{
    <div>
        <img src="/Image/InteractiveReading/@Model.Answer.Guid" alt="">
    </div>
}

@if (Model?.Answer?.ButtonInteractiveReadingOptions != null && Model?.Answer?.ButtonInteractiveReadingOptions.Count > 0)
{
    <div class="answer-bank">
        @foreach (var a in Model?.Answer?.ButtonInteractiveReadingOptions)
        {
            <span>@Html.Raw(a)</span>
        }
    </div>
}

<div id="display-after-recording">
@if (Model.Answer?.LanguageCharacters != null && Model.Answer?.LanguageCharacters != "")
    {
        <p>Use up/down arrows to switch between the test and the interface to add special characters.</p>
    }
<p class="interactive" >@Html.Raw(Model.Answer?.InteractiveReadingAnswer)</p>

<div id="question" class="hidden">@Model.Answer?.Guid</div>

@if (Model?.Answer?.ButtonInteractiveReadingOptions != null && Model?.Answer?.ButtonInteractiveReadingOptions.Count > 0)
{
    <div class="answer-bank">
        @foreach (var a in Model?.Answer?.ButtonInteractiveReadingOptions)
        {
            <span>@Html.Raw(a)</span>
        }
    </div>
}
</div>

@if (Model.Answer?.LanguageCharacters != null && Model.Answer?.LanguageCharacters != "")
{
    <div class="letters @(Model.Answer?.LanguagePopout ?? true ? "popup" : "")" role="dialog" aria-label="Special Character List" aria-describedby="letter-description">
            <div class="button-area">
                @foreach (var characterRow in (Model.Answer?.LanguageCharacters ?? "").Split(" ---- ").Select(t => t.Trim()).Where(t => !string.IsNullOrWhiteSpace(t)))
                {
                    <div class="button-row">
                        @if (!(Model.Answer?.LanguagePopout ?? true) && characterRow.First() == '1') {
                            <span class="button-blank"></span>
                        }
                        @if (!(Model.Answer?.LanguagePopout ?? true) && characterRow.First() == 'q')
                        {
                            <span class="button-blank long"></span>
                        }
                        @if (!(Model.Answer?.LanguagePopout ?? true) && characterRow.First() == 'a')
                        {
                            <span class="button-blank long2"></span>
                        }
                        @if (!(Model.Answer?.LanguagePopout ?? true) && characterRow.First() == 'z')
                        {
                            <span class="button-blank long3"></span>
                        }
                        @foreach (var character in characterRow.Split(' ').Select(t => t.Trim()).Where(t => !string.IsNullOrWhiteSpace(t)))
                        {
                            <button data-value="@character.First()" data-key="@character.Last()">@character.First()</button>
                        }
                        @if (!(Model.Answer?.LanguagePopout ?? true) && characterRow.First() == '1')
                        {
                            <span class="button-blank"></span>
                        }
                        @if (!(Model.Answer?.LanguagePopout ?? true) && characterRow.First() == 'a')
                        {
                            <span class="button-blank long2"></span>
                        }
                        @if (!(Model.Answer?.LanguagePopout ?? true) && characterRow.First() == 'z')
                        {
                            <span class="button-blank long3"></span>
                        }
                    </div>
                }
            </div>
        <p id="letter-description">Use up/down arrows to move rows. Use left/right arrows to move between the special characters.</p>
    </div>
}

<div class="answer-bank-space"><a class="il-button" id="continue">Continue</a></div>

<div>
    <p id="countdown">@Model?.Answer?.DurationAnswerInSeconds</p>
</div>


<form method="post" class="hidden" id="form">
    <input id="answer" type="hidden" value="@Model?.Answer?.Guid" name="answerguid">
    <input id="answertext" type="hidden" name="answertext">
    <input id="id" type="hidden" name="id">
</form>

@section Scripts {
    <script src="~/js/readinganswer.js?cache=11" asp-append-version="true"></script>
}
